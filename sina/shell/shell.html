<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no,minimal-ui">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<title>testP1</title>
</head>
<body>
result:<textarea id="scanRes" style="width:60%;height:100px;"></textarea>
<br>
<input type="button" value="scan" id="btnStartScan"style="width:80px;height:60px;">
<br>
<input type="button" value="test printer" id="btnPrinterTest" style="width:80px;height:60px;">
<input type="button" value="test printer2" id="btnPrinterTest2" style="width:80px;height:60px;">
<input type="button" value="test printer3" id="btnPrinterTest3" style="width:80px;height:60px;">
<input type="button" value="alert" id="btnAlert" style="width:80px;height:60px;">
<br>
<br>
<textarea id="voice" style="width:60%;height:100px;">
到款通知：支付宝到账120.90元。微信到账230.98元。嚯嚯嚯嚯哈哈！
一首古诗：春宵，苏轼。春宵一刻值千金，花有清香月有阴。歌管楼台声细细，秋千院落夜沉沉。
天之道，损有余而补不足，是故虚胜实，不足胜有余。其意博，其理奥，其趣深，天地之象分，阴阳之候列，变化之由表，死生之兆彰，不谋而遗迹自同，勿约而幽明斯契，稽其言有微，验之事不忒，诚可谓至道之宗，奉生之始矣。假若天机迅发，妙识玄通，成谋虽属乎生知，标格亦资于治训，未尝有行不由送，出不由产者亦。然刻意研精，探微索隐，或识契真要，则目牛无全，故动则有成，犹鬼神幽赞，而命世奇杰，时时间出焉。 
五藏六府之精气，皆上注于目而为之精。精之案为眼，骨之精为瞳子，筋之精为黑眼，血之精力络，其案气之精为白眼，肌肉之精为约束，裹撷筋骨血气之精而与脉并为系，上属于脑，后出于项中。故邪中于项，因逢其身之虚，其人深，则随眼系以入于脑，入手腼则脑转，脑转则引目系急，目系急则目眩以转矣。邪其精，其精所中不相比亦则精散，精散则视岐，视岐见两物。 阴极在六，何以言九。太极生两仪，天地初刨判。六阴已极，逢七归元太素，太素西方金德，阴之清纯，寒之渊源。 
</textarea>
<br>
<select onchange="voice_set_viocer(this)">
	<option value="xiaoyan">小燕—女青、中英、普通话</option>
    <option value="xiaoyu">小宇—男青、中英、普通话</option>
    <option value="catherine">凯瑟琳—女青、英</option>
    <option value="henry">亨利—男青、英</option>
    <option value="vimary">玛丽—女青、英</option>
    <option value="vixy">小研—女青、中英、普通话</option>
    <option value="xiaoqi" selected="selected">小琪—女青、中英、普通话</option>
    <option value="vixf">小峰—男青、中英、普通话</option>
    <option value="xiaomei">小梅—女青、中英、粤语</option>
    <option value="xiaolin">小莉—女青、中英、台湾普通话</option>
    <option value="xiaorong">小蓉—女青、中、四川话</option>
    <option value="xiaoqian">小芸—女青、中、东北话</option>
    <option value="xiaokun">小坤—男青、中、河南话</option>
    <option value="xiaoqiang">小强—男青、中、湖南话</option>
    <option value="vixying">小莹—女青、中、陕西话</option>
    <option value="xiaoxin">小新—男童、中、普通话</option>
    <option value="nannan">楠楠—女童、中、普通话</option>
    <option value="vils">老孙—男老、中、普通话</option>
</select>
语速：
<select onchange="voice_set_speed(this)">
	<option value="10">10</option>
	<option value="20">20</option>
	<option value="30">30</option>
	<option value="40">40</option>
	<option value="50" selected="selected">50</option>
	<option value="60">60</option>
	<option value="70">70</option>
	<option value="80">80</option>
	<option value="90">90</option>
	<option value="100">100</option>
</select>
<br>
<input type="button" value="voice_start" onclick="voice_start()" style="width:100px;height:60px;">
<input type="button" value="voice_pause" onclick="voice_pause()" style="width:100px;height:60px;">
<input type="button" value="voice_resume" onclick="voice_resume()" style="width:100px;height:60px;">
<input type="button" value="voice_stop" onclick="voice_stop()" style="width:100px;height:60px;">
<br>
账号：
<input type="text" value="test_001" id="account" placeholder="请输入账号">
<input type="button" value="register" onclick="push_register()" style="width:100px;height:60px;">
<input type="button" value="unregister" onclick="push_unregister()" style="width:100px;height:60px;">
</body>
<script src="../shell/js/shell.js"></script>
<script src="../shell/js/printer.js"></script>
<script>
///////////////////////////////////////////////////////////////////////////////////////////////

var G = function(id){
	return document.getElementById(id);
};
function trim(n){
	if(n==null)
		return null ;
	n = n + "";
	return n.replace(/(^\s+)|\s+$/g,'');
};
function voice_set_viocer(o){
	if('undefined' != typeof PosVoiceUtils){
		PosVoiceUtils.setViocer(o.value);
	}else{
		alert("not support");
	}
};
function voice_set_speed(o){
	if('undefined' != typeof PosVoiceUtils){
		PosVoiceUtils.setSpeed(o.value);
	}else{
		alert("not support");
	}
};
function voice_start(){
	if('undefined' != typeof PosVoiceUtils){
		var val = trim(G("voice").value);
		PosVoiceUtils.play(val);
	}else{
		alert("not support");
	}
};
function voice_resume(){
	if('undefined' != typeof PosVoiceUtils){
		PosVoiceUtils.resume();
	}else{
		alert("not support");
	}
};
function voice_pause(){
	if('undefined' != typeof PosVoiceUtils){
		PosVoiceUtils.pause();
	}else{
		alert("not support");
	}
};
function voice_stop(){
	if('undefined' != typeof PosVoiceUtils){
		voiceUtils.stop();
	}else{
		alert("not support");
	}
};
///////////////////////////////////////////////////////////////////////////////////////////////
function push_register(){
	var v = trim(G("account").value);
	if('undefined' != typeof PosPushUtils){
		PosPushUtils.registerPush(v);
	}else{
		alert("not support");
	}
};
function push_unregister(){
	var v = trim(G("account").value);
	if('undefined' != typeof PosPushUtils){
		PosPushUtils.unRegisterPush(v);
	}else{
		alert("not support");
	}
};
///////////////////////////////////////////////////////////////////////////////////////////////
function testPosPrinter(){
	var pd = new PrintData();
	pd
	.add(new PrintItem().setDataType(DataType.BOLD_ON | DataType.ALIGN_CENTER | DataType.STRING).setData("我是一个单店"))//加粗|居中|字符串类型
	.add(new PrintItem().setDataType(DataType.LF)) //换行
	.add(new PrintItem().setDataType(DataType.BOLD_ON | DataType.STRING).setData("消费单"))//加粗|字符串类型
	.add(new PrintItem().setDataType(DataType.LF))//换行
	.add(new PrintItem().setDataType(DataType.BOLD_OFF))//取消加粗,注意加粗之后一定要取消加粗
	.add(new PrintItem().setDataType(DataType.ALIGN_LEFT | DataType.STRING).setData("会员卡号：   8888********0001"))//居左|字符串类型
	.add(new PrintItem().setDataType(DataType.LF))//换行
	.add(new PrintItem().setDataType(DataType.STRING).setData("手机号:      130****5386"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("--------------------------------"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("现金消费：   2000元"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("--------------------------------"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("卡内余额:    8800元"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("卡内积分:    0积分"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("--------------------------------"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("小票编码:    1479786938939"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("操作时间:    2016-11-24 11:28:30"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("操作人员:    邓肯"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.STRING).setData("--------------------------------"))
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.ALIGN_CENTER | DataType.STRING).setData('本系统由"慧客科技"提供'))//居中|字符串类型
	.add(new PrintItem().setDataType(DataType.LF))
	.add(new PrintItem().setDataType(DataType.ALIGN_CENTER | DataType.STRING).setData('010-56228037'))
	.add(new PrintItem().setDataType(DataType.LF3));//3个换行符
	return pd.toJSONString();
};

function testPosPrinter2(){
	var pd = new PrintData();
	pd.addln(new PrintItem().setDataType(DataType.ALIGN_CENTER | DataType.STRING).setData("我是居中的"))
	.addln(new PrintItem().setDataType(DataType.BOLD_ON | DataType.ALIGN_CENTER | DataType.STRING).setData("我是加粗居中的"))
	.boldOff().addln(new PrintItem().setDataType(DataType.ALIGN_LEFT | DataType.STRING).setData("我是居左的"))
	.addln(new PrintItem().setDataType(DataType.ALIGN_RIGHT | DataType.STRING).setData("我是居右的"))
	.addln(new PrintItem().setDataType(DataType.ALIGN_LEFT | DataType.STRING).setData("我是有空格             的"))
	.addDotLine()
	.addStringln("我是一个字符串")
	.addTail()
	.ln3();
	return pd.toJSONString();
};
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//在android中调用，所以方法名不能改。
function posCallBackOnRecieve(v){
	G("scanRes").value = v;
};

G("btnStartScan").onclick = function(){
	if('undefined' != typeof PosScanner){
		//PosScanner是在android中定义的对象，这里可以直接调用
		PosScanner.startScan();
	}
};

G("btnPrinterTest").onclick = function(){
	var res = testPosPrinter();
	G("scanRes").value = res;
	if('undefined' != typeof PosPrinter){
	//PosPrinter是在android中定义的对象，这里可以直接调用
		PosPrinter.print(res);
	}else{
		alert("无打印机!");
	}
};

G("btnPrinterTest2").onclick = function(){
	var res = testPosPrinter2();
	G("scanRes").value = res;
	
	if('undefined' != typeof PosPrinter){
		var data = {"printItems":[{"data":"测试店2","dataType":1216},{"dataType":2},{"data":"消费单","dataType":1216},{"dataType":2},{"data":"会员卡号：  6201********0001","dataType":576},{"dataType":2},{"data":"手机号：    133****0000","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"储值消费：  1.0元","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"卡内余额：  21570.2元","dataType":576},{"dataType":2},{"data":"  (含赠送金额:300.0元)","dataType":64},{"dataType":2},{"data":"卡内积分：  500.0积分","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"小票编码：  1490847349075","dataType":576},{"dataType":2},{"data":"操作时间：  2017-03-30 12:15:49","dataType":576},{"dataType":2},{"data":"操作人员：   1","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"本系统由\"慧客科技\"提供","dataType":1088},{"dataType":2},{"data":"010-56228037","dataType":1088},{"dataType":2},{"dataType":8}]};
		PosPrinter.print(res);
	}else{
		alert("无打印机!");
	}
};

G("btnPrinterTest3").onclick = function(){
	var data = {"printItems":[{"data":"测试店2","dataType":1216},{"dataType":2},{"data":"消费单","dataType":1216},{"dataType":2},{"data":"会员卡号：  6201********0001","dataType":576},{"dataType":2},{"data":"手机号：    133****0000","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"储值消费：  1.0元","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"卡内余额：  21570.2元","dataType":576},{"dataType":2},{"data":"  (含赠送金额:300.0元)","dataType":64},{"dataType":2},{"data":"卡内积分：  500.0积分","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"小票编码：  1490847349075","dataType":576},{"dataType":2},{"data":"操作时间：  2017-03-30 12:15:49","dataType":576},{"dataType":2},{"data":"操作人员：   1","dataType":576},{"dataType":2},{"data":"--------------------------------","dataType":64},{"dataType":2},{"data":"本系统由\"慧客科技\"提供","dataType":1088},{"dataType":2},{"data":"010-56228037","dataType":1088},{"dataType":2},{"dataType":8}]};
	var res = JSON.stringify(data);
	G("scanRes").value = res
	
	if('undefined' != typeof PosPrinter){
		PosPrinter.print(res);
	}else{
		alert("无打印机!");
	}
};

G("btnAlert").onclick = function(){
	if('undefined' != typeof PosUtils){
		PosUtils.alert("hello!");
	}
};
</script>
</html>